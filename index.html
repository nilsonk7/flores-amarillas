<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Flores Amarillas para Ti 💛</title>
<style>
  :root{
    --txt:#111;
    --glass: rgba(255,255,255,.38);
    --shadow: 0 30px 80px rgba(0,0,0,.35);
  }

  /* ===== Lienzo ===== */
  html,body{height:100%}
  body{
    margin:0; font-family: "Georgia","Segoe UI",system-ui,sans-serif;
    background:#f8e7a8; color:var(--txt); overflow:hidden;
  }

  /* ===== Fondo con una foto (Ken Burns) ===== */
  .bg{
    position:fixed; inset:0; background: #000 center/cover no-repeat;
    transform: scale(1.08);  /* poquito zoom inicial */
    will-change: transform;
    animation: kenburns 22s ease-in-out infinite alternate;
    filter: saturate(1.05) contrast(1.02) brightness(1.02);
  }
  .bg::before{
    content:""; position:absolute; inset:0;
    background: radial-gradient(120% 80% at 50% 20%, rgba(255,242,182,.55), rgba(0,0,0,.25) 70%);
    mix-blend-mode: soft-light;
  }
  .bg::after{
    content:""; position:absolute; inset:0;
    background: radial-gradient(120% 90% at 50% 50%, transparent 60%, rgba(0,0,0,.35));
    pointer-events:none;
  }
  @keyframes kenburns{
    0%   { transform: scale(1.08) translate3d(0,0,0); }
    100% { transform: scale(1.18) translate3d(2%, -2%, 0); }
  }

  /* ===== Partículas (bokeh) ===== */
  .spark{
    position:fixed; bottom:-12px; width:8px; height:8px; border-radius:50%;
    background:rgba(255,223,0,.9);
    box-shadow:0 0 12px rgba(255,225,100,.9);
    animation:float 8s linear infinite;
  }
  @keyframes float{
    from{ transform: translateY(0) scale(1); opacity:.9 }
    to  { transform: translateY(-110vh) scale(.6); opacity:0 }
  }

  /* ===== Portada para habilitar audio ===== */
  .cover{
    position:fixed; inset:0; display:grid; place-items:center; z-index:99;
    background:linear-gradient(180deg,rgba(0,0,0,.45),rgba(0,0,0,.25));
    animation:fadeIn .35s ease;
  }
  @keyframes fadeIn{ from{opacity:.6} to{opacity:1} }
  .card{
    backdrop-filter: blur(8px);
    background:var(--glass);
    padding:22px 26px; border-radius:18px; text-align:center; color:#1a1a1a;
    box-shadow:var(--shadow);
    filter:blur(14px); opacity:0; transform:translateY(8px) scale(1.02);
  }
  .card.show{ animation:focusIn .8s ease forwards .25s; }
  @keyframes focusIn{ to{ filter:blur(0); opacity:1; transform:none; } }

  .open-btn{
    margin-top:12px; padding:12px 18px; border-radius:12px; border:1px solid rgba(0,0,0,.12);
    cursor:pointer; background:#fff; font-weight:800; font-size:16px;
    box-shadow:0 10px 28px rgba(0,0,0,.15);
  }
  .hide{ display:none !important; }

  /* ===== Contenido principal (glass) ===== */
  .container{
    position:relative; z-index:2; display:flex; flex-direction:column;
    gap:18px; align-items:center; justify-content:center; height:100%;
    padding:24px; box-sizing:border-box;
  }

  .glass{
    max-width:min(900px,92vw); padding:22px 26px; border-radius:18px;
    background:var(--glass); backdrop-filter: blur(7px);
    box-shadow:var(--shadow);
  }

  h1{
    margin:0 0 6px; font-size:clamp(22px,3.2vw,40px); letter-spacing:.3px;
    color:#222; text-shadow:1px 1px 6px rgba(0,0,0,.18);
  }

  /* Texto con máquina de escribir sutil */
  #mensaje{ margin:0; white-space:pre-line; line-height:1.55; font-size:clamp(16px,2.1vw,22px); }
  .type{ border-right:2px solid rgba(0,0,0,.6); white-space:pre-wrap; overflow:hidden; animation:caret .9s infinite; }
  @keyframes caret{ 0%,100%{border-color:transparent} 50%{border-color:rgba(0,0,0,.6)} }

  /* Bloque de letra sincronizada */
  .lyrics{
    margin:0; white-space:pre-line; line-height:1.6; font-size:clamp(16px,2vw,21px);
    color:#222;
  }
  .line{ opacity:.28; transform:translateY(2px); transition:all .35s ease; }
  .line.active{ opacity:1; transform:none; text-shadow:0 1px 10px rgba(255,255,255,.55); }

  /* Barra compartir */
  .sharebar{
    position:fixed; bottom:12px; left:50%; transform:translateX(-50%);
    display:flex; gap:8px; align-items:center;
    background:rgba(255,255,255,.65); backdrop-filter:blur(6px);
    border:1px solid rgba(0,0,0,.08); padding:8px 12px; border-radius:12px;
    box-shadow:0 10px 28px rgba(0,0,0,.18); font-weight:700; z-index:20;
  }
  .sharebar a{ color:#1b1b1b; text-decoration:none }
  .sbtn{
    padding:6px 10px; border-radius:10px; border:1px solid rgba(0,0,0,.1);
    background:#fff; cursor:pointer; font-weight:700;
  }

  @media (max-width:640px){ .lyrics{font-size:17px} }
</style>
</head>
<body>

  <!-- Fondo con UNA foto -->
  <div class="bg" id="bg"></div>

  <!-- Portada -->
  <div id="cover" class="cover">
    <div class="card show">
      <div style="font-size:18px; font-weight:800; margin-bottom:6px;">💛 Tengo un regalo para ti</div>
      <div style="opacity:.85">Toca para abrirlo (activa el sonido y las animaciones)</div>
      <button id="openGift" class="open-btn">Abrir regalo</button>
    </div>
  </div>

  <!-- Audio -->
  <audio id="bgAudio" loop preload="auto" playsinline>
    <source src="audio/te_robare.mp3" type="audio/mpeg" />
  </audio>

  <!-- Contenido -->
  <div class="container">
    <section class="glass card" id="introCard">
      <h1>Flores Amarillas para Ti</h1>
      <p id="mensaje" class="type"></p>
    </section>

    <section class="glass card" id="lyricsCard" style="display:none">
      <h1 style="margin-bottom:10px">Letra</h1>
      <div id="lyrics" class="lyrics"></div>
    </section>
  </div>

  <!-- Compartir -->
  <div class="sharebar">
    <a id="shareLink" href="#" target="_blank" rel="noopener noreferrer">htts/flores amaarillas</a>
    <button id="btnShare" class="sbtn">Compartir</button>
    <button id="btnCopy"  class="sbtn">Copiar link</button>
  </div>

<script>
  /* ===== Config: una sola foto de fondo ===== */
  const BACKGROUND_IMAGE = "flor3.webp"; // cambia por flor1.webp si prefieres

  /* ===== Mensaje (sin '\n' visibles; usamos plantillas con saltos reales) ===== */
  const mensaje21 = `💛 Feliz 21 de Septiembre, amor.

Hoy te regalo un ramo que no se marchita: flores amarillas eternas hechas con cariño.

Si algún día el mundo se apaga, tu sonrisa me vuelve a encender.

Promesa firmada: cuando nos veamos, llevo flores reales y un abrazo de larga duración. 🌼✨`;

  const mensajeNormal = `Flores amarillas para ti 🌼

Un detalle que no caduca: abre esta página cuando quieras un rayito de sol.`;

  /* ===== Letras sincronizadas (edita textos y tiempos) =====
     ⚠️ Evito poner letras protegidas. Coloca tus propias frases/versos.
     t = segundo donde debe activarse la línea
  */
  const LYRICS = [
    { t: 2,  text: "Hoy te pienso en amarillo: luz que no se apaga." },
    { t: 10, text: "Cada pétalo es un ‘te quiero’ que se queda." },
    { t: 18, text: "Si el mundo se hace ruido, tú eres mi melodía." },
    { t: 26, text: "Y si faltan flores físicas, te regalo esta eternidad digital." }
  ];

  /* ===== Utilidades ===== */
  const bg = document.getElementById('bg');
  bg.style.backgroundImage = `url('${BACKGROUND_IMAGE}')`;

  const cover = document.getElementById('cover');
  const audio = document.getElementById('bgAudio');

  const msj = document.getElementById('mensaje');
  const lyricsWrap = document.getElementById('lyrics');
  const lyricsCard = document.getElementById('lyricsCard');

  function es21Sept(d=new Date()){ return d.getDate()===21 && (d.getMonth()+1)===9; }

  function typeWriter(texto, velocidad=24){
    msj.textContent = "";
    let i = 0;
    const tick = () => {
      msj.textContent += texto.slice(i, i+2);
      i += 2;
      if(i < texto.length) setTimeout(tick, velocidad);
    };
    setTimeout(tick, 260);
  }

  // Render inicial del mensaje
  typeWriter(es21Sept() ? mensaje21 : mensajeNormal);

  // Monta contenedor de letras
  function renderLyrics(){
    lyricsWrap.innerHTML = LYRICS.map((l,i)=>`<div class="line" id="line-${i}">${l.text}</div>`).join("");
  }

  function syncLyrics(currentTime){
    for(let i=0;i<LYRICS.length;i++){
      const on = currentTime >= LYRICS[i].t && (i===LYRICS.length-1 || currentTime < LYRICS[i+1].t);
      const el = document.getElementById(`line-${i}`);
      if(el) el.classList.toggle('active', on);
    }
  }

  /* ===== Partículas ===== */
  function particula(){
    const s = document.createElement("div");
    s.className = "spark";
    s.style.left = Math.random()*100 + "vw";
    s.style.animationDuration = (5 + Math.random()*4) + "s";
    document.body.appendChild(s);
    setTimeout(()=>s.remove(), 9000);
  }

  /* ===== Iniciar experiencia ===== */
  async function start(){
    // mostrar tarjetas con blur->foco
    document.getElementById('introCard').classList.add('show');
    cover.classList.add('hide');

    // audio (inicia al toque)
    try{ audio.volume = 0.8; await audio.play(); }catch(e){}

    // letras
    renderLyrics();
    lyricsCard.style.display = "block";

    // partículas
    particula(); setInterval(particula, 240);

    // sincronizar letras al tiempo del audio
    audio.addEventListener('timeupdate', ()=> syncLyrics(audio.currentTime));
  }

  document.getElementById('openGift').addEventListener('click', start);

  /* ===== Compartir / Copiar link ===== */
  const realURL = window.location.href;
  const shareA = document.getElementById('shareLink');
  shareA.href = realURL;

  document.getElementById('btnShare').addEventListener('click', async ()=>{
    if(navigator.share){
      try{ await navigator.share({ title:"Flores Amarillas 💛", text:"Abrí mi regalo 🌼", url: realURL }); }catch(e){}
    }else{
      try{ await navigator.clipboard.writeText(realURL); }catch(e){}
    }
  });
  document.getElementById('btnCopy').addEventListener('click', async ()=>{
    try{
      await navigator.clipboard.writeText(realURL);
      const b = document.getElementById('btnCopy'); b.textContent="Copiado ✅";
      setTimeout(()=> b.textContent="Copiar link", 1500);
    }catch(e){}
  });
</script>
</body>
</html>
